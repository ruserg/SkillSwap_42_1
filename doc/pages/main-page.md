# Главная страница

Главная страница приложения с фильтрами пользователей и отображением карточек.

## Обоснование решения

**Маршрут:** `/`

**Почему главная страница не защищена:**

- Должна быть доступна всем пользователям (авторизованным и нет)
- Является точкой входа в приложение
- Позволяет неавторизованным пользователям видеть возможности платформы

**Композиция:**

- **Filter** (widget) - фильтрация пользователей по навыкам, городу, полу
- **UserCardsSection** (widget) - отображение карточек пользователей
- Логика фильтрации вынесена в `features/filter-users` для переиспользования

**Почему бизнес-логика в features, а не в page:**

- Фильтрация может использоваться и на других страницах
- Упрощает тестирование - логику можно тестировать отдельно от UI
- Соответствует принципам FSD - pages только композиция

## Импорт

```typescript
import { MainPage } from "@pages/MainPage/MainPage";
```

## Структура

```
MainPage/
├── MainPage.tsx           # Композиция виджетов
└── mainPage.module.scss   # Стили страницы
```

## Компоненты

### Filter Widget

Виджет фильтрации пользователей.

```typescript
<Filter
  subcategories={subcategories}
  onFiltersChange={setFilters}
/>
```

**Ответственность:**

- Отображение фильтров (навыки, город, пол)
- Сбор выбранных значений фильтров
- Передача изменений в родительский компонент

### UserCardsSection Widget

Секция отображения карточек пользователей.

```typescript
<UserCardsSection
  filters={filters}
  sentinelRef={sentinelRef}
/>
```

**Ответственность:**

- Загрузка пользователей из API
- Фильтрация пользователей через `useFilteredUsers`
- Отображение карточек с пагинацией
- Бесконечная прокрутка через Intersection Observer

## Состояние

### Локальное состояние (useState)

- `filters` - текущие значения фильтров (навыки, город, пол)
- Хранится на уровне страницы для передачи в виджеты

### Глобальное состояние (Redux)

- `entities/user` - данные пользователей
- `entities/skill` - навыки для фильтрации
- `entities/category` - категории и подкатегории
- `entities/city` - города для фильтрации

## Поток данных

```
1. Пользователь выбирает фильтры → Filter вызывает onFiltersChange
2. MainPage обновляет filters через setFilters
3. UserCardsSection получает новые filters через props
4. useFilteredUsers пересчитывает отфильтрованных пользователей
5. Компонент перерисовывается с новыми данными
```

## Пагинация и бесконечная прокрутка

**Почему используется бесконечная прокрутка, а не пагинация:**

- Лучший UX для мобильных устройств
- Пользователь может быстро просматривать большое количество карточек
- Не нужно кликать на "Следующая страница"

**Реализация:**

- Используется `useInfinityScroll` хук
- Intersection Observer отслеживает sentinel элемент
- При появлении sentinel загружается следующая порция данных

## Примеры использования

### Базовая навигация

```typescript
// В Routes.tsx
<Route
  index
  element={
    <PageMeta
      title="Обмен навыками"
      description="SkillSwap — уникальная платформа для взаимного обучения."
    >
      <MainPage />
    </PageMeta>
  }
/>
```

## Связанные компоненты

- [Filter Widget](../widgets/filter.md) - виджет фильтрации
- [UserCardsSection Widget](../widgets/user-cards-section.md) - секция карточек
- [Feature Filter Users](../features/filter-users.md) - логика фильтрации
- [Card Component](../components/ui-components.md#card) - компонент карточки

## См. также

- [Архитектура проекта](../guides/architecture.md)
- [Роутинг](../guides/routing.md)
